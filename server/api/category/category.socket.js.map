{"version":3,"sources":["api/category/category.socket.js"],"names":["register","CategoryEvents","require","events","socket","i","eventsLength","length","event","listener","createListener","on","removeListener","doc","emit"],"mappings":"AAAA;;;;AAIA;;;;;QAOgBA,Q,GAAAA,Q;AALhB,IAAIC,iBAAiBC,QAAQ,mBAAR,CAArB;;AAEA;AACA,IAAIC,SAAS,CAAC,MAAD,EAAS,QAAT,CAAb;;AAEO,SAASH,QAAT,CAAkBI,MAAlB,EAA0B;AAC/B;AACA,OAAK,IAAIC,IAAI,CAAR,EAAWC,eAAeH,OAAOI,MAAtC,EAA8CF,IAAIC,YAAlD,EAAgED,GAAhE,EAAqE;AACnE,QAAIG,QAAQL,OAAOE,CAAP,CAAZ;AACA,QAAII,WAAWC,eAAe,cAAcF,KAA7B,EAAoCJ,MAApC,CAAf;;AAEAH,mBAAeU,EAAf,CAAkBH,KAAlB,EAAyBC,QAAzB;AACAL,WAAOO,EAAP,CAAU,YAAV,EAAwBC,eAAeJ,KAAf,EAAsBC,QAAtB,CAAxB;AACD;AACF;;AAGD,SAASC,cAAT,CAAwBF,KAAxB,EAA+BJ,MAA/B,EAAuC;AACrC,SAAO,UAASS,GAAT,EAAc;AACnBT,WAAOU,IAAP,CAAYN,KAAZ,EAAmBK,GAAnB;AACD,GAFD;AAGD;;AAED,SAASD,cAAT,CAAwBJ,KAAxB,EAA+BC,QAA/B,EAAyC;AACvC,SAAO,YAAW;AAChBR,mBAAeW,cAAf,CAA8BJ,KAA9B,EAAqCC,QAArC;AACD,GAFD;AAGD","file":"category.socket.js","sourcesContent":["/**\r\n * Broadcast updates to client when the model changes\r\n */\r\n\r\n'use strict';\r\n\r\nvar CategoryEvents = require('./category.events');\r\n\r\n// Model events to emit\r\nvar events = ['save', 'remove'];\r\n\r\nexport function register(socket) {\r\n  // Bind model events to socket events\r\n  for (var i = 0, eventsLength = events.length; i < eventsLength; i++) {\r\n    var event = events[i];\r\n    var listener = createListener('category:' + event, socket);\r\n\r\n    CategoryEvents.on(event, listener);\r\n    socket.on('disconnect', removeListener(event, listener));\r\n  }\r\n}\r\n\r\n\r\nfunction createListener(event, socket) {\r\n  return function(doc) {\r\n    socket.emit(event, doc);\r\n  };\r\n}\r\n\r\nfunction removeListener(event, listener) {\r\n  return function() {\r\n    CategoryEvents.removeListener(event, listener);\r\n  };\r\n}\r\n"]}